# OpenPerturbation

> **The open-source platform for end-to-end perturbation biology â€“ causal discovery, multimodal fusion & optimal intervention design.**

<p align="center">
  <img src="Logo.svg" alt="OpenPerturbation logo" width="260"/>
</p>

<p align="center">
  <a href="https://github.com/llamasearchai/OpenPerturbation/actions/workflows/python-ci.yml"><img src="https://github.com/llamasearchai/OpenPerturbation/actions/workflows/python-ci.yml/badge.svg" alt="CI Status"></a>
  <a href="https://llamasearchai.github.io/OpenPerturbation"><img src="https://img.shields.io/badge/docs-live-brightgreen" alt="Documentation"></a>
  <a href="https://img.shields.io/pypi/v/openperturbation"><img src="https://img.shields.io/pypi/v/openperturbation?color=brightgreen" alt="PyPI version"></a>
  <a href="https://codecov.io/gh/llamasearchai/OpenPerturbation"><img src="https://codecov.io/gh/llamasearchai/OpenPerturbation/branch/main/graph/badge.svg" alt="Coverage"></a>
  <a href="https://img.shields.io/badge/License-MIT-blue.svg"><img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="License"></a>
  <a href="https://github.com/llamasearchai/OpenPerturbation/releases"><img src="https://img.shields.io/github/v/release/llamasearchai/OpenPerturbation?include_prereleases" alt="GitHub release"></a>
</p>

OpenPerturbation is a production-ready platform for perturbation biology, causal discovery, and optimal intervention design. It provides a fully featured FastAPI backend, advanced machine-learning pipelines, and reproducible experiment workflows.

**Author:** Nik Jois  
**Email:** nikjois@llamasearch.ai

---

## Table of Contents
1. [Features](#key-features)
2. [Quick Start](#quick-start)
3. [Project Structure](#project-structure)
4. [API Overview](#api-overview)
5. [Documentation](#documentation)
6. [Benchmarks](#benchmarks)
7. [Contributing](#contributing)
8. [License](#license)
9. [Citation](#citation)
10. [Contact](#contact)
11. [Environment Variables and Secrets](#environment-variables-and-secrets)

---

## Key Features

* **Causal Discovery** â€“ PC, GES, LiNGAM and correlation-based algorithms out-of-the-box.
* **Intervention Design** â€“ Data-driven recommendations of optimal genetic / chemical perturbations.
* **Multimodal Fusion** â€“ Native integration of genomics, imaging & chemical-structure data.
* **Explainability** â€“ Attention maps, concept activation & pathway analysis included.
* **Extensible REST API** â€“ 25 fully typed endpoints with autogenerated OpenAPI & Swagger docs.
* **Docker & CI/CD** â€“ Containerised deployment & GitHub Actions workflow for continuous integration.
* **Comprehensive Tests** â€“ Unit, integration & end-to-end suites with â‰¥ 90 % coverage.
* **Production-Ready** â€“ Typed Python â‰¥ 3.10, Pydantic v2 models, FastAPI async I/O & HTTPS-ready.

---

## Quick Start

### Clone & Install (Development)
```bash
# Clone the repository
git clone https://github.com/llamasearchai/OpenPerturbation.git
cd OpenPerturbation

# Create & activate virtual environment
python -m venv .venv
source .venv/bin/activate      # Windows: .venv\Scripts\activate

# Install in editable mode with all extras
pip install -e ".[dev]"

# Run the test-suite (optional)
pytest -q

# Launch the API server
openperturbation               # or: python -m src.api.server
```

### Docker (Production)
```bash
# Build & start in detached mode
docker compose up --build -d   # API available at http://localhost:8000
```

### Python Package
```bash
pip install openperturbation
openperturbation --help
```

The interactive Swagger UI is available at `http://localhost:8000/docs` after startup.

---

## Project Structure
```text
OpenPerturbation/
â”œâ”€â”€ src/                   # Application & ML code
â”‚   â”œâ”€â”€ api/               # FastAPI app
â”‚   â”œâ”€â”€ causal/            # Discovery & intervention
â”‚   â”œâ”€â”€ models/            # Vision / graph / fusion models
â”‚   â”œâ”€â”€ training/          # PyTorch-Lightning modules
â”‚   â””â”€â”€ utils/             # Helpers
â”œâ”€â”€ tests/                 # Test-suite
â”œâ”€â”€ docs/                  # Documentation source
â”œâ”€â”€ docker/                # Container assets
â””â”€â”€ configs/               # Configuration files
```

---

## API Overview
| Method | Path | Description |
| ------ | ---- | ----------- |
| GET | `/health` | Service liveness probe |
| POST | `/causal-discovery` | Run causal discovery |
| POST | `/intervention-design` | Recommend interventions |
| POST | `/analysis/start` | Launch analysis pipeline |
| GET | `/analysis/{job_id}/status` | Retrieve job status |
| â€¦ | *20+ more* | See `/docs` for full list |

---

## Documentation

ðŸ“š **Complete documentation is available at: [llamasearchai.github.io/OpenPerturbation](https://llamasearchai.github.io/OpenPerturbation)**

- [Quick Start Guide](https://llamasearchai.github.io/OpenPerturbation/quick_start/)
- [API Reference](https://llamasearchai.github.io/OpenPerturbation/api_reference/)
- [Deployment Guide](https://llamasearchai.github.io/OpenPerturbation/deployment/)
- [About & Architecture](https://llamasearchai.github.io/OpenPerturbation/about/)

---

## Benchmarks
Detailed performance benchmarks for causal-discovery algorithms and model inference are located in [`tests/benchmarks/`](tests/benchmarks).  All reported numbers are reproducible via `pytest -k benchmarks`.

---

## Contributing
We welcome contributions!  Please read [CONTRIBUTING.md](CONTRIBUTING.md) for guidelines on bug reports, feature requests and pull-requests.  All contributors must follow our Code of Conduct.

---

## License
OpenPerturbation is released under the MIT License â€“ see [LICENSE](LICENSE) for details.

---

## Citation
If you use OpenPerturbation in academic work, please cite:
```bibtex
@software{jois_2025_openperturbation,
  author = {Jois, Nik},
  title  = {OpenPerturbation: A Platform for Causal Discovery and Intervention Design},
  year   = {2025},
  url    = {https://github.com/llamasearchai/OpenPerturbation}
}
```

---

## Contact & Hiring
Created and maintained by **Nik Jois** â€¹[nikjois@llamasearch.ai](mailto:nikjois@llamasearch.ai)â€º.  
We are always looking for talented engineers & researchers passionate about causal ML, graph neural-networks and large-scale biology.  Feel free to reach out or submit a PR â€“ **let's build the future of perturbation biology together!**

## About
See the full project background, vision and architecture in the [About](https://llamasearchai.github.io/OpenPerturbation/about/) section of the documentation.

## Environment Variables and Secrets

OpenPerturbation relies on certain external service API tokens (for example, OpenAI) that **must** be supplied via environment variables. The project uses `python-dotenv` to automatically load variables from a local `.env` file at runtime.

1. Copy `.env.example` to `.env` at the repository root.
2. Populate the required variables:

```
OPENAI_API_KEY=sk-...
```

3. Never commit the `.env` file to version control. The file path is included in `.gitignore`.

At runtime the key is resolved in this order of precedence:

1. Explicit argument passed to `OpenPerturbationAgent`.
2. `OPENAI_API_KEY` exported in the environment.
3. `OPENAI_API_KEY` loaded from `.env` via `python-dotenv`.

If no key is detected, the agent will safely switch to mock mode without external calls.